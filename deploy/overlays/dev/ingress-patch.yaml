apiVersion: networking.k8s.io/v1
kind: Ingress

metadata:
  name: qcon-api-ingress
# ingress to rewrite project url to pod root
# (https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#rewrite)  
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /$2
    # nginx.ingress.kubernetes.io/add-base-url: "true"
    # nginx.ingress.kubernetes.io/configuration-snippet: |
    #   rewrite ^(/app1)/(.*)$ $1/$2 redirect;
    # nginx.ingress.kubernetes.io/use-regex: "true"
    # nginx.ingress.kubernetes.io/x-forwarded-prefix: "/app1/"
    # nginx.ingress.kubernetes.io/app-root: /app1/
spec:
  rules:
    # - host: qcon-api-ingress.default-v.142.232.76.249.sslip.io
    - http:
        paths:
        - path: /app1(/|$)(.*)/
          pathType: Prefix
          backend:
            service:
              name: qcon-api-service
              port:
                number: 8000